import{b7 as k}from"./DPHdV5Tz.js";function Y(S,x){for(var w=0;w<x.length;w++){const v=x[w];if(typeof v!="string"&&!Array.isArray(v)){for(const d in v)if(d!=="default"&&!(d in S)){const b=Object.getOwnPropertyDescriptor(v,d);b&&Object.defineProperty(S,d,b.get?b:{enumerable:!0,get:()=>v[d]})}}}return Object.freeze(Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}))}var L={exports:{}};(function(S){(function(x){S.exports?(x.default=x,S.exports=x):x(typeof Highcharts<"u"?Highcharts:void 0)})(function(x){var w=x?x._modules:{};function v(d,b,p,m){d.hasOwnProperty(b)||(d[b]=m.apply(null,p),typeof CustomEvent=="function"&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:b,module:d[b]}})))}v(w,"Data/Modifiers/DataModifier.js",[w["Core/Utilities.js"]],function(d){var b;let{addEvent:p,fireEvent:m,merge:g}=d;class n{benchmark(r,e){let s=[],o=this,i=()=>{o.modifyTable(r),o.emit({type:"afterBenchmarkIteration"})},{iterations:l}=g({iterations:1},e);o.on("afterBenchmarkIteration",()=>{if(s.length===l){o.emit({type:"afterBenchmark",results:s});return}i()});let a={startTime:0,endTime:0};return o.on("modify",()=>{a.startTime=window.performance.now()}),o.on("afterModify",()=>{a.endTime=window.performance.now(),s.push(a.endTime-a.startTime)}),i(),s}emit(r){m(this,r.type,r)}modify(r,e){let s=this;return new Promise((o,i)=>{r.modified===r&&(r.modified=r.clone(!1,e));try{o(s.modifyTable(r,e))}catch(l){s.emit({type:"error",detail:e,table:r}),i(l)}})}modifyCell(r,e,s,o,i){return this.modifyTable(r)}modifyColumns(r,e,s,o){return this.modifyTable(r)}modifyRows(r,e,s,o){return this.modifyTable(r)}on(r,e){return p(this,r,e)}}return(b=n||(n={})).types={},b.registerType=function(t,r){return!!t&&!b.types[t]&&!!(b.types[t]=r)},n}),v(w,"Data/DataTable.js",[w["Core/Utilities.js"]],function(d){let{addEvent:b,fireEvent:p,uniqueKey:m}=d;class g{static isNull(t){if(t===g.NULL)return!0;if(t instanceof Array){if(!t.length)return!1;for(let r=0,e=t.length;r<e;++r)if(t[r]!==null)return!1}else{let r=Object.keys(t);if(!r.length)return!1;for(let e=0,s=r.length;e<s;++e)if(t[r[e]]!==null)return!1}return!0}constructor(t={}){this.aliases=t.aliases?JSON.parse(JSON.stringify(t.aliases)):{},this.autoId=!t.id,this.columns={},this.id=t.id||m(),this.modified=this,this.rowCount=0,this.versionTag=m();let r=t.columns||{},e=Object.keys(r),s=this.columns,o=0;for(let h=0,c=e.length,u,C;h<c;++h)u=r[C=e[h]].slice(),s[C]=u,o=Math.max(o,u.length);for(let h=0,c=e.length;h<c;++h)s[e[h]].length=o;this.rowCount=o;let i=t.aliases||{},l=Object.keys(i),a=this.aliases;for(let h=0,c=l.length,u;h<c;++h)a[u=l[h]]=i[u]}clone(t,r){let e={};this.emit({type:"cloneTable",detail:r}),t||(e.aliases=this.aliases,e.columns=this.columns),this.autoId||(e.id=this.id);let s=new g(e);return t||(s.versionTag=this.versionTag),this.emit({type:"afterCloneTable",detail:r,tableClone:s}),s}deleteColumnAlias(t){let r=this.aliases[t],e=this.modifier;return r&&(delete this.aliases[t],e&&e.modifyColumns(this,{[r]:Array(this.rowCount)},0)),r}deleteColumns(t,r){let e=this.columns,s={},o={},i=this.modifier,l=this.rowCount;if((t=t||Object.keys(e)).length){this.emit({type:"deleteColumns",columnNames:t,detail:r});for(let a=0,h=t.length,c,u;a<h;++a)(c=e[u=t[a]])&&(s[u]=c,o[u]=Array(l)),delete e[u];return Object.keys(e).length||(this.rowCount=0),i&&i.modifyColumns(this,o,0,r),this.emit({type:"afterDeleteColumns",columns:s,columnNames:t,detail:r}),s}}deleteRows(t,r=1,e){let s=[],o=[],i=this.modifier;if(this.emit({type:"deleteRows",detail:e,rowCount:r,rowIndex:t||0}),t===void 0&&(t=0,r=this.rowCount),r>0&&t<this.rowCount){let l=this.columns,a=Object.keys(l);for(let h=0,c=a.length,u,C;h<c;++h){C=(u=l[a[h]]).splice(t,r),h||(this.rowCount=u.length);for(let f=0,y=C.length;f<y;++f)s[f]=s[f]||[],s[f][h]=C[f];o.push(Array(c))}}return i&&i.modifyRows(this,o,t||0,e),this.emit({type:"afterDeleteRows",detail:e,rowCount:r,rowIndex:t||0,rows:s}),s}emit(t){switch(t.type){case"afterDeleteColumns":case"afterDeleteRows":case"afterSetCell":case"afterSetColumns":case"afterSetRows":this.versionTag=m()}p(this,t.type,t)}getCell(t,r){t=this.aliases[t]||t;let e=this.columns[t];if(e)return e[r]}getCellAsBoolean(t,r){t=this.aliases[t]||t;let e=this.columns[t];return!!(e&&e[r])}getCellAsNumber(t,r,e){t=this.aliases[t]||t;let s=this.columns[t],o=s&&s[r];switch(typeof o){case"boolean":return o?1:0;case"number":return isNaN(o)&&!e?null:o}return isNaN(o=parseFloat(`${o}`))&&!e?null:o}getCellAsString(t,r){t=this.aliases[t]||t;let e=this.columns[t];return`${e&&e[r]}`}getColumn(t,r){return this.getColumns([t],r)[t]}getColumnAsNumbers(t,r){let e=this.columns[t=this.aliases[t]||t],s=[];if(e){let o=e.length;if(r)for(let i=0;i<o;++i)s.push(this.getCellAsNumber(t,i,!0));else{for(let i=0,l;i<o;++i){if(typeof(l=e[i])=="number")return e.slice();if(l!=null)break}for(let i=0;i<o;++i)s.push(this.getCellAsNumber(t,i))}}return s}getColumnNames(){return Object.keys(this.columns)}getColumns(t,r){let e=this.aliases,s=this.columns,o={};t=t||Object.keys(s);for(let i=0,l=t.length,a,h;i<l;++i)(a=s[e[h=t[i]]||h])&&(o[h]=r?a:a.slice());return o}getModifier(){return this.modifier}getRow(t,r){return this.getRows(t,1,r)[0]}getRowCount(){return this.rowCount}getRowIndexBy(t,r,e){t=this.aliases[t]||t;let s=this.columns[t];if(s){let o=s.indexOf(r,e);if(o!==-1)return o}}getRowObject(t,r){return this.getRowObjects(t,1,r)[0]}getRowObjects(t=0,r=this.rowCount-t,e){let s=this.aliases,o=this.columns,i=Array(r);e=e||Object.keys(o);for(let l=t,a=0,h=Math.min(this.rowCount,t+r),c,u;l<h;++l,++a)for(let C of(u=i[a]={},e))c=o[s[C]||C],u[C]=c?c[l]:void 0;return i}getRows(t=0,r=this.rowCount-t,e){let s=this.aliases,o=this.columns,i=Array(r);e=e||Object.keys(o);for(let l=t,a=0,h=Math.min(this.rowCount,t+r),c,u;l<h;++l,++a)for(let C of(u=i[a]=[],e))c=o[s[C]||C],u.push(c?c[l]:void 0);return i}getVersionTag(){return this.versionTag}hasColumns(t){let r=this.aliases,e=this.columns;for(let s=0,o=t.length,i;s<o;++s)if(!e[i=t[s]]&&!r[i])return!1;return!0}hasRowWith(t,r){t=this.aliases[t]||t;let e=this.columns[t];return!!e&&e.indexOf(r)!==-1}on(t,r){return b(this,t,r)}renameColumn(t,r){let e=this.columns;if(e[t]){if(t!==r){let s=this.aliases;s[r]&&delete s[r],e[r]=e[t],delete e[t]}return!0}return!1}setCell(t,r,e,s){let o=this.columns,i=this.modifier,l=o[t=this.aliases[t]||t];l&&l[r]===e||(this.emit({type:"setCell",cellValue:e,columnName:t,detail:s,rowIndex:r}),l||(l=o[t]=Array(this.rowCount)),r>=this.rowCount&&(this.rowCount=r+1),l[r]=e,i&&i.modifyCell(this,t,r,e),this.emit({type:"afterSetCell",cellValue:e,columnName:t,detail:s,rowIndex:r}))}setColumn(t,r=[],e=0,s){this.setColumns({[t]:r},e,s)}setColumns(t,r,e){let s=this.columns,o=this.modifier,i=r===void 0,l=Object.keys(t);this.emit({type:"setColumns",columns:t,columnNames:l,detail:e,rowIndex:r});for(let h=0,c=l.length,u,C;h<c;++h)if(u=t[C=l[h]],C=this.aliases[C]||C,i)s[C]=u.slice(),this.rowCount=u.length;else{let f=s[C]?s[C]:s[C]=Array(this.rowCount);for(let y=r||0,R=u.length;y<R;++y)f[y]=u[y];this.rowCount=Math.max(this.rowCount,f.length)}let a=Object.keys(s);for(let h=0,c=a.length;h<c;++h)s[a[h]].length=this.rowCount;o&&o.modifyColumns(this,t,r||0),this.emit({type:"afterSetColumns",columns:t,columnNames:l,detail:e,rowIndex:r})}setModifier(t,r){let e=this;return e.emit({type:"setModifier",detail:r,modifier:t,modified:e.modified}),e.modified=e,e.modifier=t,(t?t.modify(e):Promise.resolve(e)).then(s=>(s.emit({type:"afterSetModifier",detail:r,modifier:t,modified:s.modified}),s)).catch(s=>{throw e.emit({type:"setModifierError",error:s,modifier:t,modified:e.modified}),s})}setRow(t,r,e){this.setRows([t],r,e)}setRows(t,r=this.rowCount,e){let s=this.aliases,o=this.columns,i=Object.keys(o),l=this.modifier,a=t.length;this.emit({type:"setRows",detail:e,rowCount:a,rowIndex:r,rows:t});for(let c=0,u=r,C;c<a;++c,++u)if((C=t[c])===g.NULL)for(let f=0,y=i.length;f<y;++f)o[i[f]][u]=null;else if(C instanceof Array)for(let f=0,y=i.length;f<y;++f)o[i[f]][u]=C[f];else{let f=Object.keys(C);for(let y=0,R=f.length,M;y<R;++y)o[M=s[M=f[y]]||M]||(o[M]=Array(u+1)),o[M][u]=C[M]}let h=r+a;if(h>this.rowCount){this.rowCount=h;for(let c=0,u=i.length;c<u;++c)o[i[c]].length=h}l&&l.modifyRows(this,t,r),this.emit({type:"afterSetRows",detail:e,rowCount:a,rowIndex:r,rows:t})}}return g.NULL={},g.version="1.0.0",g}),v(w,"Data/Connectors/DataConnector.js",[w["Data/Modifiers/DataModifier.js"],w["Data/DataTable.js"],w["Core/Utilities.js"]],function(d,b,p){var m;let{addEvent:g,fireEvent:n,merge:t,pick:r}=p;class e{constructor(o={}){this.table=new b(o.dataTable),this.metadata=o.metadata||{columns:{}}}get polling(){return!!this.polling}describeColumn(o,i){let l=this.metadata.columns;l[o]=t(l[o]||{},i)}describeColumns(o){let i,l=Object.keys(o);for(;typeof(i=l.pop())=="string";)this.describeColumn(i,o[i])}emit(o){n(this,o.type,o)}getColumnOrder(o){let i=this.metadata.columns,l=Object.keys(i||{});if(l.length)return l.sort((a,h)=>r(i[a].index,0)-r(i[h].index,0))}getSortedColumns(o){return this.table.getColumns(this.getColumnOrder(o))}load(){return n(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(o,i){return g(this,o,i)}save(){return n(this,"saveError",{table:this.table}),Promise.reject(Error("Not implemented"))}setColumnOrder(o){for(let i=0,l=o.length;i<l;++i)this.describeColumn(o[i],{index:i})}setModifierOptions(o){let i=o&&d.types[o.type];return this.table.setModifier(i?new i(o):void 0).then(()=>this)}startPolling(o=1e3){let i=this;window.clearTimeout(i._polling),i._polling=window.setTimeout(()=>i.load().catch(l=>i.emit({type:"loadError",error:l,table:i.table})).then(()=>{i._polling&&i.startPolling(o)}),o)}stopPolling(){window.clearTimeout(this._polling),delete this._polling}whatIs(o){return this.metadata.columns[o]}}return(m=e||(e={})).types={},m.registerType=function(s,o){return!!s&&!m.types[s]&&!!(m.types[s]=o)},e}),v(w,"Data/Converters/DataConverter.js",[w["Data/DataTable.js"],w["Core/Utilities.js"]],function(d,b){let{addEvent:p,fireEvent:m,isNumber:g,merge:n}=b;class t{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^([0-9]{4})([\-\.\/])([0-9]{1,2})\2([0-9]{1,2})$/,parser:function(i){return i?Date.UTC(+i[1],i[3]-1,+i[4]):NaN}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(i){return i?Date.UTC(+i[4],i[3]-1,+i[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(i){return i?Date.UTC(+i[4],i[1]-1,+i[3]):NaN}},"dd/mm/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(i){let l=new Date;if(!i)return NaN;let a=+i[4];return a>l.getFullYear()-2e3?a+=1900:a+=2e3,Date.UTC(a,i[3]-1,+i[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(i){return i?Date.UTC(+i[4]+2e3,i[1]-1,+i[3]):NaN}}};let s=n(t.defaultOptions,e),o=s.decimalPoint;(o==="."||o===",")&&(o=o==="."?"\\.":",",this.decimalRegExp=RegExp("^(-?[0-9]+)"+o+"([0-9]+)$")),this.options=s}asBoolean(e){return typeof e=="boolean"?e:typeof e=="string"?e!==""&&e!=="0"&&e!=="false":!!this.asNumber(e)}asDate(e){let s;if(typeof e=="string")s=this.parseDate(e);else if(typeof e=="number")s=e;else{if(e instanceof Date)return e;s=this.parseDate(this.asString(e))}return new Date(s)}asGuessedType(e){return{number:this.asNumber,Date:this.asDate,string:this.asString}[this.guessType(e)].call(this,e)}asNumber(e){if(typeof e=="number")return e;if(typeof e=="boolean")return e?1:0;if(typeof e=="string"){let s=this.decimalRegExp;if(e.indexOf(" ")>-1&&(e=e.replace(/\s+/g,"")),s){if(!s.test(e))return NaN;e=e.replace(s,"$1.$2")}return parseFloat(e)}return e instanceof Date?e.getDate():e?e.getRowCount():NaN}asString(e){return""+e}deduceDateFormat(e,s,o){let i=[],l=[],a="YYYY/mm/dd",h,c=[],u=0,C=!1,f,y;for((!s||s>e.length)&&(s=e.length);u<s;u++)if(e[u]!==void 0&&e[u]&&e[u].length)for(y=0,h=e[u].trim().replace(/[-\.\/]/g," ").split(" "),c=["","",""];y<h.length;y++)y<c.length&&(f=parseInt(h[y],10))&&(l[y]=!l[y]||l[y]<f?f:l[y],i[y]!==void 0?i[y]!==f&&(i[y]=!1):i[y]=f,f>31?f<100?c[y]="YY":c[y]="YYYY":f>12&&f<=31?(c[y]="dd",C=!0):c[y].length||(c[y]="mm"));if(C){for(y=0;y<i.length;y++)i[y]!==!1?l[y]>12&&c[y]!=="YY"&&c[y]!=="YYYY"&&(c[y]="YY"):l[y]>12&&c[y]==="mm"&&(c[y]="dd");c.length===3&&c[1]==="dd"&&c[2]==="dd"&&(c[2]="YY"),a=c.join("/")}return o&&(this.options.dateFormat=a),a}emit(e){m(this,e.type,e)}export(e,s){throw this.emit({type:"exportError",columns:[],headers:[]}),Error("Not implemented")}getTable(){throw Error("Not implemented")}guessType(e){let s="string";if(typeof e=="string"){let o=this.trim(`${e}`),i=this.decimalRegExp,l=this.trim(o,!0);i&&(l=i.test(l)?l.replace(i,"$1.$2"):"");let a=parseFloat(l);+l===a?e=a:s=g(this.parseDate(e))?"Date":"string"}return typeof e=="number"&&(s=e>31536e6?"Date":"number"),s}on(e,s){return p(this,e,s)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),Error("Not implemented")}parseDate(e,s){let o=this.options,i=s||o.dateFormat,l=NaN,a,h,c;if(o.parseDate)l=o.parseDate(e);else{if(i)(h=this.dateFormats[i])||(h=this.dateFormats["YYYY/mm/dd"]),(c=e.match(h.regex))&&(l=h.parser(c));else for(a in this.dateFormats)if(h=this.dateFormats[a],c=e.match(h.regex)){i=a,l=h.parser(c);break}!c&&(typeof(c=Date.parse(e))=="object"&&c!==null&&c.getTime?l=c.getTime()-6e4*c.getTimezoneOffset():g(c)&&(l=c-6e4*new Date(c).getTimezoneOffset(),e.indexOf("2001")===-1&&new Date(l).getFullYear()===2001&&(l=NaN)))}return l}trim(e,s){return typeof e=="string"&&(e=e.replace(/^\s+|\s+$/g,""),s&&/^[0-9\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}return t.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},(t||(t={})).getTableFromColumns=function(r=[],e=[]){let s=new d;for(let o=0,i=Math.max(e.length,r.length);o<i;++o)s.setColumn(e[o]||`${o}`,r[o]);return s},t}),v(w,"Data/DataCursor.js",[],function(){class d{constructor(p={}){this.emittingRegister=[],this.listenerMap={},this.stateMap=p}addListener(p,m,g){let n=this.listenerMap[p]=this.listenerMap[p]||{};return(n[m]=n[m]||[]).push(g),this}buildEmittingTag(p){return(p.cursor.type==="position"?[p.table.id,p.cursor.column,p.cursor.row,p.cursor.state,p.cursor.type]:[p.table.id,p.cursor.columns,p.cursor.firstRow,p.cursor.lastRow,p.cursor.state,p.cursor.type]).join("\0")}emitCursor(p,m,g,n){let t=p.id,r=m.state,e=this.listenerMap[t]&&this.listenerMap[t][r];if(e){let s=this.stateMap[t]=this.stateMap[t]??{},o=s[m.state]||[];n&&(o.length||(s[m.state]=o),d.getIndex(m,o)===-1&&o.push(m));let i={cursor:m,cursors:o,table:p};g&&(i.event=g);let l=this.emittingRegister,a=this.buildEmittingTag(i);if(l.indexOf(a)>=0)return this;try{this.emittingRegister.push(a);for(let h=0,c=e.length;h<c;++h)e[h].call(this,i)}finally{let h=this.emittingRegister.indexOf(a);h>=0&&this.emittingRegister.splice(h,1)}}return this}remitCursor(p,m){let g=this.stateMap[p]&&this.stateMap[p][m.state];if(g){let n=d.getIndex(m,g);n>=0&&g.splice(n,1)}return this}removeListener(p,m,g){let n=this.listenerMap[p]&&this.listenerMap[p][m];if(n){let t=n.indexOf(g);t>=0&&n.splice(t,1)}return this}}return d.version="1.0.0",function(b){function p(m,g){if(m.type==="range")return m;let n={type:"range",firstRow:m.row??(g&&g.firstRow)??0,lastRow:m.row??(g&&g.lastRow)??Number.MAX_VALUE,state:m.state};return m.column!==void 0&&(n.columns=[m.column]),n}b.getIndex=function(m,g){if(m.type==="position"){for(let n,t=0,r=g.length;t<r;++t)if((n=g[t]).type==="position"&&n.state===m.state&&n.column===m.column&&n.row===m.row)return t}else{let n=JSON.stringify(m.columns);for(let t,r=0,e=g.length;r<e;++r)if((t=g[r]).type==="range"&&t.state===m.state&&t.firstRow===m.firstRow&&t.lastRow===m.lastRow&&JSON.stringify(t.columns)===n)return r}return-1},b.isEqual=function(m,g){return m.type==="position"&&g.type==="position"?m.column===g.column&&m.row===g.row&&m.state===g.state:m.type==="range"&&g.type==="range"&&m.firstRow===g.firstRow&&m.lastRow===g.lastRow&&JSON.stringify(m.columns)===JSON.stringify(g.columns)},b.isInRange=function(m,g){g.type==="position"&&(g=p(g)),m.type==="position"&&(m=p(m,g));let n=m.columns,t=g.columns;return m.firstRow>=g.firstRow&&m.lastRow<=g.lastRow&&(!n||!t||n.every(r=>t.indexOf(r)>=0))},b.toPositions=function(m){if(m.type==="position")return[m];let g=m.columns||[],n=[],t=m.state;for(let r=m.firstRow,e=m.lastRow;r<e;++r){if(!g.length){n.push({type:"position",row:r,state:t});continue}for(let s=0,o=g.length;s<o;++s)n.push({type:"position",column:g[s],row:r,state:t})}return n},b.toRange=p}(d||(d={})),d}),v(w,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}}),v(w,"Data/DataPool.js",[w["Data/Connectors/DataConnector.js"],w["Data/DataPoolDefaults.js"],w["Core/Utilities.js"]],function(d,b,p){class m{constructor(n=b){n.connectors=n.connectors||[],this.connectors={},this.options=n,this.waiting={}}emit(n){p.fireEvent(this,n.type,n)}getConnector(n){let t=this.connectors[n];if(t)return Promise.resolve(t);let r=this.waiting[n];if(!r){r=this.waiting[n]=[];let e=this.getConnectorOptions(n);if(!e)throw Error(`Connector '${n}' not found.`);this.loadConnector(e).then(s=>{delete this.waiting[n];for(let o=0,i=r.length;o<i;++o)r[o][0](s)}).catch(s=>{delete this.waiting[n];for(let o=0,i=r.length;o<i;++o)r[o][1](s)})}return new Promise((e,s)=>{r.push([e,s])})}getConnectorIds(){let n=this.options.connectors,t=[];for(let r=0,e=n.length;r<e;++r)t.push(n[r].id);return t}getConnectorOptions(n){let t=this.options.connectors;for(let r=0,e=t.length;r<e;++r)if(t[r].id===n)return t[r]}getConnectorTable(n){return this.getConnector(n).then(t=>t.table)}isNewConnector(n){return!this.connectors[n]}loadConnector(n){return new Promise((t,r)=>{this.emit({type:"load",options:n});let e=d.types[n.type];if(!e)throw Error(`Connector type not found. (${n.type})`);new e(n.options).load().then(s=>{this.connectors[n.id]=s,this.emit({type:"afterLoad",options:n}),t(s)}).catch(r)})}on(n,t){return p.addEvent(this,n,t)}setConnectorOptions(n){let t=this.options.connectors,r=this.connectors;this.emit({type:"setConnectorOptions",options:n});for(let e=0,s=t.length;e<s;++e)if(t[e].id===n.id){t.splice(e,1);break}r[n.id]&&(r[n.id].stopPolling(),delete r[n.id]),t.push(n),this.emit({type:"afterSetConnectorOptions",options:n})}}return m.version="1.0.0",m}),v(w,"Data/Formula/FormulaParser.js",[],function(){let d=/^(?:FALSE|TRUE)/,b=/^[+-]?\d+(?:\.\d+)?(?:e[+-]\d+)?/,p=/^[+-]?\d+(?:,\d+)?(?:e[+-]\d+)?/,m=/^([A-Z][A-Z\d\.]*)\(/,g=/^(?:[+\-*\/^<=>]|<=|=>)/,n=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/,t=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/,r=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/,e=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function s(h){let c=0;for(let u=0,C=h.length,f,y=1;u<C;++u){if((f=h[u])==="("){c||(y=u+1),++c;continue}if(f===")"&&!--c)return h.substring(y,u)}if(c>0){let u=Error("Incomplete parantheses.");throw u.name="FormulaParseError",u}return""}function o(h){let c=-1;for(let C=0,f=h.length,y,R=!1;C<f;++C){if((y=h[C])==="\\"){R=!R;continue}if(R){R=!1;continue}if(y==='"'){if(!(c<0))return h.substring(c+1,C);c=C}}let u=Error("Incomplete string.");throw u.name="FormulaParseError",u}function i(h,c){let u;if(u=h.match(t)){let f=u[2]===""||u[2][0]==="[",y=u[1]===""||u[1][0]==="[",R=u[4]===""||u[4][0]==="[",M=u[3]===""||u[3][0]==="[",F={type:"range",beginColumn:f?parseInt(u[2].substring(1,-1)||"0",10):parseInt(u[2],10)-1,beginRow:y?parseInt(u[1].substring(1,-1)||"0",10):parseInt(u[1],10)-1,endColumn:R?parseInt(u[4].substring(1,-1)||"0",10):parseInt(u[4],10)-1,endRow:M?parseInt(u[3].substring(1,-1)||"0",10):parseInt(u[3],10)-1};return f&&(F.beginColumnRelative=!0),y&&(F.beginRowRelative=!0),R&&(F.endColumnRelative=!0),M&&(F.endRowRelative=!0),F}if(u=h.match(n)){let f=u[1][0]!=="$",y=u[2][0]!=="$",R=u[3][0]!=="$",M=u[4][0]!=="$",F={type:"range",beginColumn:a(f?u[1]:u[1].substring(1))-1,beginRow:parseInt(y?u[2]:u[2].substring(1),10)-1,endColumn:a(R?u[3]:u[3].substring(1))-1,endRow:parseInt(M?u[4]:u[4].substring(1),10)-1};return f&&(F.beginColumnRelative=!0),y&&(F.beginRowRelative=!0),R&&(F.endColumnRelative=!0),M&&(F.endRowRelative=!0),F}let C=l(h,c);return C.length===1&&typeof C[0]!="string"?C[0]:C}function l(h,c){let u=c?p:b,C=[],f,y=(h[0]==="="?h.substring(1):h).trim();for(;y;){if(f=y.match(e)){let F=f[2]===""||f[2][0]==="[",D=f[1]===""||f[1][0]==="[",N={type:"reference",column:F?parseInt(f[2].substring(1,-1)||"0",10):parseInt(f[2],10)-1,row:D?parseInt(f[1].substring(1,-1)||"0",10):parseInt(f[1],10)-1};F&&(N.columnRelative=!0),D&&(N.rowRelative=!0),C.push(N),y=y.substring(f[0].length).trim();continue}if(f=y.match(r)){let F=f[1][0]!=="$",D=f[2][0]!=="$",N={type:"reference",column:a(F?f[1]:f[1].substring(1))-1,row:parseInt(D?f[2]:f[2].substring(1),10)-1};F&&(N.columnRelative=!0),D&&(N.rowRelative=!0),C.push(N),y=y.substring(f[0].length).trim();continue}if(f=y.match(g)){C.push(f[0]),y=y.substring(f[0].length).trim();continue}if(f=y.match(d)){C.push(f[0]==="TRUE"),y=y.substring(f[0].length).trim();continue}if(f=y.match(u)){C.push(parseFloat(f[0])),y=y.substring(f[0].length).trim();continue}if(y[0]==='"'){let F=o(y);C.push(F.substring(1,-1)),y=y.substring(F.length+2).trim();continue}if(f=y.match(m)){let F=s(y=y.substring(f[1].length).trim());C.push({type:"function",name:f[1],args:function(D,N){let j=[],T=N?";":",",A=0,E="";for(let O=0,V=D.length,P;O<V;++O)if((P=D[O])===T&&!A&&E)j.push(i(E,N)),E="";else if(P!=='"'||A||E)P!==" "&&(E+=P,P==="("?++A:P===")"&&--A);else{let I=o(D.substring(O));j.push(I),O+=I.length+1}return!A&&E&&j.push(i(E,N)),j}(F,c)}),y=y.substring(F.length+2).trim();continue}if(y[0]==="("){let F=s(y);if(F){C.push(l(F,c)),y=y.substring(F.length+2).trim();continue}}let R=h.length-y.length,M=Error("Unexpected character `"+h.substring(R,R+1)+"` at position "+(R+1)+". (`..."+h.substring(R-5,R+6)+"...`)");throw M.name="FormulaParseError",M}return C}function a(h){let c=0;for(let u=0,C=h.length,f,y=h.length-1;u<C;++u)(f=h.charCodeAt(u))>=65&&f<=90&&(c+=(f-64)*Math.pow(26,y)),--y;return c}return{parseFormula:l}}),v(w,"Data/Formula/FormulaTypes.js",[],function(){let d=["+","-","*","/","^","=","<","<=",">",">="];return{isFormula:function(b){return b instanceof Array},isFunction:function(b){return typeof b=="object"&&!(b instanceof Array)&&b.type==="function"},isOperator:function(b){return typeof b=="string"&&d.indexOf(b)>=0},isRange:function(b){return typeof b=="object"&&!(b instanceof Array)&&b.type==="range"},isReference:function(b){return typeof b=="object"&&!(b instanceof Array)&&b.type==="reference"},isValue:function(b){return typeof b=="boolean"||typeof b=="number"||typeof b=="string"}}}),v(w,"Data/Formula/FormulaProcessor.js",[w["Data/Formula/FormulaTypes.js"]],function(d){let{isFormula:b,isFunction:p,isOperator:m,isRange:g,isReference:n,isValue:t}=d,r=/ */,e=Number.MAX_VALUE/1.000000000001,s=Number.MAX_VALUE/1.000000000002,o=Number.MAX_VALUE,i={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},l={},a=/^[A-Z][A-Z\.]*$/;function h(D){switch(typeof D){case"boolean":return D?o:e;case"string":return s;case"number":return D;default:return NaN}}function c(D){return typeof D=="string"?D.toLowerCase().replace(r,"\0"):D}function u(D){switch(typeof D){case"boolean":return D?1:0;case"string":return parseFloat(D.replace(",","."));case"number":return D;default:return NaN}}function C(D,N,j){let T;switch(D){case"=":return c(N)===c(j);case"<":return typeof N==typeof j?c(N)<c(j):h(N)<h(j);case"<=":return typeof N==typeof j?c(N)<=c(j):h(N)<=h(j);case">":return typeof N==typeof j?c(N)>c(j):h(N)>h(j);case">=":return typeof N==typeof j?c(N)>=c(j):h(N)>=h(j)}switch(N=u(N),j=u(j),D){case"+":T=N+j;break;case"-":T=N-j;break;case"*":T=N*j;break;case"/":T=N/j;break;case"^":T=Math.pow(N,j);break;default:return NaN}return T%1?Math.round(1e9*T)/1e9:T}function f(D,N){return t(D)?D:g(D)?N&&y(D,N)||[]:p(D)?F(D,N):M(b(D)?D:[D],N)}function y(D,N){let j=N.getColumnNames().slice(D.beginColumn,D.endColumn+1),T=[];for(let A=0,E=j.length,O;A<E;++A){let V=N.getColumn(j[A],!0)||[];for(let P=D.beginRow,I=D.endRow+1;P<I;++P)typeof(O=V[P])=="string"&&O[0]==="="&&N!==N.modified&&(O=N.modified.getCell(j[A],P)),T.push(t(O)?O:NaN)}return T}function R(D,N){let j=N.getColumnNames()[D.column];if(j){let T=N.getCell(j,D.row);if(typeof T=="string"&&T[0]==="="&&N!==N.modified){let A=N.modified.getCell(j,D.row);return t(A)?A:NaN}return t(T)?T:NaN}return NaN}function M(D,N){let j;for(let T=0,A=D.length,E,O,V,P;T<A;++T){if(m(E=D[T])){O=E;continue}if(t(E)?P=E:b(E)?P=M(D,N):p(E)?P=t(V=F(E,N))?V:NaN:n(E)&&(P=N&&R(E,N)),P!==void 0){if(j===void 0)j=O?C(O,0,P):P;else{if(!O)return NaN;let I=D[T+1];m(I)&&i[I]>i[O]&&(P=C(I,P,M(D.slice(T+2))),T=A),j=C(O,j,P)}O=void 0,P=void 0}}return t(j)?j:NaN}function F(D,N,j){let T=l[D.name];if(T)try{return T(D.args,N)}catch{return NaN}let A=Error(`Function "${D.name}" not found.`);throw A.name="FormulaProcessError",A}return{asNumber:u,getArgumentValue:f,getArgumentsValues:function(D,N){let j=[];for(let T=0,A=D.length;T<A;++T)j.push(f(D[T],N));return j},getRangeValues:y,getReferenceValue:R,processFormula:M,processorFunctions:l,registerProcessorFunction:function(D,N){return a.test(D)&&!l[D]&&!!(l[D]=N)},translateReferences:function D(N,j=0,T=0){for(let A=0,E=N.length,O;A<E;++A)(O=N[A])instanceof Array?D(O,j,T):p(O)?D(O.args,j,T):g(O)?(O.beginColumnRelative&&(O.beginColumn+=j),O.beginRowRelative&&(O.beginRow+=T),O.endColumnRelative&&(O.endColumn+=j),O.endRowRelative&&(O.endRow+=T)):n(O)&&(O.columnRelative&&(O.column+=j),O.rowRelative&&(O.row+=T));return N}}}),v(w,"Data/Formula/Functions/ABS.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function p(m,g){let n=b(m[0],g);switch(typeof n){case"number":return Math.abs(n);case"object":{let t=[];for(let r=0,e=n.length,s;r<e;++r){if(typeof(s=n[r])!="number")return NaN;t.push(Math.abs(s))}return t}default:return NaN}}return d.registerProcessorFunction("ABS",p),p}),v(w,"Data/Formula/Functions/AND.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function p(m,g){for(let n=0,t=m.length,r;n<t;++n)if(!(r=b(m[n],g))||typeof r=="object"&&!p(r,g))return!1;return!0}return d.registerProcessorFunction("AND",p),p}),v(w,"Data/Formula/Functions/AVERAGE.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentsValues:b}=d;function p(m,g){let n=b(m,g),t=0,r=0;for(let e=0,s=n.length,o;e<s;++e)switch(typeof(o=n[e])){case"number":isNaN(o)||(++t,r+=o);break;case"object":for(let i=0,l=o.length,a;i<l;++i)typeof(a=o[i])!="number"||isNaN(a)||(++t,r+=a)}return t?r/t:0}return d.registerProcessorFunction("AVERAGE",p),p}),v(w,"Data/Formula/Functions/AVERAGEA.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function p(m,g){let n=0,t=0;for(let r=0,e=m.length,s;r<e;++r)switch(typeof(s=b(m[r],g))){case"boolean":++n,t+=s?1:0;continue;case"number":isNaN(s)||(++n,t+=s);continue;case"string":++n;continue;default:for(let o=0,i=s.length,l;o<i;++o)switch(typeof(l=s[o])){case"boolean":++n,t+=l?1:0;continue;case"number":isNaN(l)||(++n,t+=l);continue;case"string":++n;continue}continue}return n?t/n:0}return d.registerProcessorFunction("AVERAGEA",p),p}),v(w,"Data/Formula/Functions/COUNT.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){function b(p,m){let g=d.getArgumentsValues(p,m),n=0;for(let t=0,r=g.length,e;t<r;++t)switch(typeof(e=g[t])){case"number":!isNaN(e)&&++n;break;case"object":n+=b(e,m)}return n}return d.registerProcessorFunction("COUNT",b),b}),v(w,"Data/Formula/Functions/COUNTA.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){function b(p,m){let g=d.getArgumentsValues(p,m),n=0;for(let t=0,r=g.length,e;t<r;++t){switch(typeof(e=g[t])){case"number":if(isNaN(e))continue;break;case"object":n+=b(e,m);continue;case"string":if(!e)continue}++n}return n}return d.registerProcessorFunction("COUNTA",b),b}),v(w,"Data/Formula/Functions/IF.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function p(m,g){return b(m[0],g)?b(m[1],g):b(m[2],g)}return d.registerProcessorFunction("IF",p),p}),v(w,"Data/Formula/Functions/ISNA.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function p(m,g){let n=b(m[0],g);return typeof n!="number"||isNaN(n)}return d.registerProcessorFunction("ISNA",p),p}),v(w,"Data/Formula/Functions/MAX.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentsValues:b}=d;function p(m,g){let n=b(m,g),t=Number.NEGATIVE_INFINITY;for(let r=0,e=n.length,s;r<e;++r)switch(typeof(s=n[r])){case"number":s>t&&(t=s);break;case"object":(s=p(s))>t&&(t=s)}return isFinite(t)?t:0}return d.registerProcessorFunction("MAX",p),p}),v(w,"Data/Formula/Functions/MEDIAN.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){function b(p,m){let g=[],n=d.getArgumentsValues(p,m);for(let e=0,s=n.length,o;e<s;++e)switch(typeof(o=n[e])){case"number":isNaN(o)||g.push(o);break;case"object":for(let i=0,l=o.length,a;i<l;++i)typeof(a=o[i])!="number"||isNaN(a)||g.push(a)}let t=g.length;if(!t)return NaN;let r=Math.floor(t/2);return t%2?g[r]:(g[r-1]+g[r])/2}return d.registerProcessorFunction("MEDIAN",b),b}),v(w,"Data/Formula/Functions/MIN.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentsValues:b}=d;function p(m,g){let n=b(m,g),t=Number.POSITIVE_INFINITY;for(let r=0,e=n.length,s;r<e;++r)switch(typeof(s=n[r])){case"number":s<t&&(t=s);break;case"object":(s=p(s))<t&&(t=s)}return isFinite(t)?t:0}return d.registerProcessorFunction("MIN",p),p}),v(w,"Data/Formula/Functions/MOD.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function p(m,g){let n=b(m[0],g),t=b(m[1],g);return typeof n=="object"&&(n=n[0]),typeof t=="object"&&(t=t[0]),typeof n!="number"||typeof t!="number"||t===0?NaN:n%t}return d.registerProcessorFunction("MOD",p),p}),v(w,"Data/Formula/Functions/MODE.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){function b(g,n){let t={},r=d.getArgumentsValues(g,n);for(let e=0,s=r.length,o;e<s;++e)switch(typeof(o=r[e])){case"number":isNaN(o)||(t[o]=(t[o]||0)+1);break;case"object":for(let i=0,l=o.length,a;i<l;++i)typeof(a=o[i])!="number"||isNaN(a)||(t[a]=(t[a]||0)+1)}return t}function p(g,n){let t=b(g,n),r=Object.keys(t);if(!r.length)return NaN;let e=[parseFloat(r[0])],s=t[r[0]];for(let o=1,i=r.length,l,a;o<i;++o)s<(a=t[l=r[o]])?(e=[parseFloat(l)],s=a):s===a&&e.push(parseFloat(l));return s>1?e:NaN}function m(g,n){let t=b(g,n),r=Object.keys(t);if(!r.length)return NaN;let e=parseFloat(r[0]),s=t[r[0]];for(let o=1,i=r.length,l,a,h;o<i;++o)s<(h=t[l=r[o]])?(e=parseFloat(l),s=h):s===h&&e>(a=parseFloat(l))&&(e=a,s=h);return s>1?e:NaN}return d.registerProcessorFunction("MODE",m),d.registerProcessorFunction("MODE.MULT",p),d.registerProcessorFunction("MODE.SNGL",m),{MULT:p,SNGL:m}}),v(w,"Data/Formula/Functions/NOT.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function p(m,g){let n=b(m[0],g);switch(typeof n=="object"&&(n=n[0]),typeof n){case"boolean":case"number":return!n}return NaN}return d.registerProcessorFunction("NOT",p),p}),v(w,"Data/Formula/Functions/OR.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function p(m,g){for(let n=0,t=m.length,r;n<t;++n)if(typeof(r=b(m[n],g))=="object"){if(p(r,g))return!0}else if(r)return!0;return!1}return d.registerProcessorFunction("OR",p),p}),v(w,"Data/Formula/Functions/PRODUCT.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentsValues:b}=d;function p(m,g){let n=b(m,g),t=1,r=!1;for(let e=0,s=n.length,o;e<s;++e)switch(typeof(o=n[e])){case"number":isNaN(o)||(r=!0,t*=o);break;case"object":r=!0,t*=p(o,g)}return r?t:0}return d.registerProcessorFunction("PRODUCT",p),p}),v(w,"Data/Formula/Functions/SUM.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){function b(p,m){let g=d.getArgumentsValues(p,m),n=0;for(let t=0,r=g.length,e;t<r;++t)switch(typeof(e=g[t])){case"number":isNaN(e)||(n+=e);break;case"object":n+=b(e,m)}return n}return d.registerProcessorFunction("SUM",b),b}),v(w,"Data/Formula/Functions/XOR.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function p(m,g){for(let n=0,t=m.length,r,e;n<t;++n)switch(typeof(e=b(m[n],g))){case"boolean":case"number":if(r===void 0)r=!!e;else if(!!e!==r)return!0;break;case"object":for(let s=0,o=e.length,i;s<o;++s)switch(typeof(i=e[s])){case"boolean":case"number":if(r===void 0)r=!!i;else if(!!i!==r)return!0}}return!1}return d.registerProcessorFunction("XOR",p),p}),v(w,"Data/Formula/Formula.js",[w["Data/Formula/FormulaParser.js"],w["Data/Formula/FormulaProcessor.js"],w["Data/Formula/FormulaTypes.js"]],function(d,b,p){return{...d,...b,...p}}),v(w,"Data/Converters/CSVConverter.js",[w["Data/Converters/DataConverter.js"],w["Core/Utilities.js"]],function(d,b){let{merge:p}=b;class m extends d{constructor(n){let t=p(m.defaultOptions,n);super(t),this.columns=[],this.headers=[],this.dataTypes=[],this.options=t}export(n,t=this.options){let{useLocalDecimalPoint:r,lineDelimiter:e}=t,s=this.options.firstRowAsNames!==!1,{decimalPoint:o,itemDelimiter:i}=t;o||(o=i!==","&&r?1.1.toLocaleString()[1]:"."),i||(i=o===","?";":",");let l=n.getSortedColumns(t.usePresentationOrder),a=Object.keys(l),h=[],c=a.length,u=[];s&&h.push(a.map(C=>`"${C}"`).join(i));for(let C=0;C<c;C++){let f,y=a[C],R=l[y],M=R.length,F=n.whatIs(y);F&&(f=F.dataType);for(let D=0;D<M;D++){let N=R[D];if(u[D]||(u[D]=[]),f==="string"?N='"'+N+'"':typeof N=="number"?N=String(N).replace(".",o):typeof N=="string"&&(N=`"${N}"`),u[D][C]=N,C===c-1){let j=C;for(;u[D].length>2&&u[D][j]===void 0;)u[D].pop(),j--;h.push(u[D].join(i))}}}return h.join(e)}parse(n,t){let r=this.dataTypes,e=p(this.options,n),{beforeParse:s,lineDelimiter:o,firstRowAsNames:i,itemDelimiter:l}=e,a,h=0,{csv:c,startRow:u,endRow:C}=e,f;if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers}),c&&s&&(c=s(c)),c){if(a=c.replace(/\r\n|\r/g,`
`).split(o||`
`),(!u||u<0)&&(u=0),(!C||C>=a.length)&&(C=a.length-1),l||(this.guessedItemDelimiter=this.guessDelimiter(a)),i){let R=a[0].split(l||this.guessedItemDelimiter||",");for(let M=0;M<R.length;M++)R[M]=R[M].trim().replace(/^["']|["']$/g,"");this.headers=R,u++}let y=0;for(h=u;h<=C;h++)a[h][0]==="#"?y++:this.parseCSVRow(a[h],h-u-y);r.length&&r[0].length&&r[0][1]==="date"&&!this.options.dateFormat&&this.deduceDateFormat(this.columns[0],null,!0);for(let R=0,M=this.columns.length;R<M;++R){f=this.columns[R];for(let F=0,D=f.length;F<D;++F)if(f[F]&&typeof f[F]=="string"){let N=this.asGuessedType(f[F]);N instanceof Date&&(N=N.getTime()),this.columns[R][F]=N}}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.headers})}parseCSVRow(n,t){let r=this,e=r.columns||[],s=r.dataTypes,{startColumn:o,endColumn:i}=r.options,l=r.options.itemDelimiter||r.guessedItemDelimiter,{decimalPoint:a}=r.options;a&&a!==l||(a=r.guessedDecimalPoint||".");let h=0,c="",u="",C=0,f=0,y=F=>{c=n[F]},R=F=>{s.length<f+1&&s.push([F]),s[f][s[f].length-1]!==F&&s[f].push(F)},M=()=>{if(o>C||C>i){++C,u="";return}if(typeof u=="string"?!isNaN(parseFloat(u))&&isFinite(u)?(u=parseFloat(u),R("number")):isNaN(Date.parse(u))?R("string"):(u=u.replace(/\//g,"-"),R("date")):R("number"),e.length<f+1&&e.push([]),typeof u!="number"&&r.guessType(u)!=="number"&&a){let F=u;u=u.replace(a,"."),r.guessType(u)!=="number"&&(u=F)}e[f][t]=u,u="",++f,++C};if(n.trim().length&&n.trim()[0]!=="#"){for(;h<n.length;h++){if(y(h),c==="#"&&!/^#[0-9a-f]{3,3}|[0-9a-f]{6,6}/i.test(n.substring(h))){M();return}if(c==='"')for(y(++h);h<n.length&&c!=='"';)u+=c,y(++h);else c===l?M():u+=c}M()}}guessDelimiter(n){let t=0,r=0,e,s={",":0,";":0,"	":0},o=n.length;for(let i=0;i<o;i++){let l=!1,a,h,c,u="";if(i>13)break;let C=n[i];for(let f=0;f<C.length&&(a=C[f],h=C[f+1],c=C[f-1],a!=="#");f++){if(a==='"')if(l){if(c!=='"'&&h!=='"'){for(;h===" "&&f<C.length;)h=C[++f];s[h]!==void 0&&s[h]++,l=!1}}else l=!0;else s[a]!==void 0?(isNaN(Date.parse(u=u.trim()))?(isNaN(Number(u))||!isFinite(Number(u)))&&s[a]++:s[a]++,u=""):u+=a;a===","&&r++,a==="."&&t++}}return s[";"]>s[","]?e=";":(s[","],s[";"],e=","),t>r?this.guessedDecimalPoint=".":this.guessedDecimalPoint=",",e}getTable(){return d.getTableFromColumns(this.columns,this.headers)}}return m.defaultOptions={...d.defaultOptions,lineDelimiter:`
`},m}),v(w,"Data/Connectors/CSVConnector.js",[w["Data/Converters/CSVConverter.js"],w["Data/Connectors/DataConnector.js"],w["Core/Utilities.js"]],function(d,b,p){let{merge:m}=p;class g extends b{constructor(t){let r=m(g.defaultOptions,t);super(r),this.converter=new d(r),this.options=r,r.enablePolling&&this.startPolling(1e3*Math.max(r.dataRefreshRate||0,1))}load(t){let r=this,e=r.converter,s=r.table,{csv:o,csvURL:i,dataModifier:l}=r.options;return r.emit({type:"load",csv:o,detail:t,table:s}),Promise.resolve(i?fetch(i).then(a=>a.text()):o||"").then(a=>(a&&(s.deleteColumns(),e.parse({csv:a}),s.setColumns(e.getTable().getColumns())),r.setModifierOptions(l).then(()=>a))).then(a=>(r.emit({type:"afterLoad",csv:a,detail:t,table:s}),r)).catch(a=>{throw r.emit({type:"loadError",detail:t,error:a,table:s}),a})}}return g.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},b.registerType("CSV",g),g}),v(w,"Data/Converters/JSONConverter.js",[w["Data/Converters/DataConverter.js"],w["Data/DataTable.js"],w["Core/Utilities.js"]],function(d,b,p){let{error:m,isArray:g,merge:n,objectEach:t}=p;class r extends d{constructor(s){let o=n(r.defaultOptions,s);super(o),this.columns=[],this.headers=[],this.options=o,this.table=new b}parse(s,o){let{beforeParse:i,orientation:l,firstRowAsNames:a,columnNames:h}=s=n(this.options,s),c=s.data;if(c){if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:o,headers:this.headers}),i&&(c=i(c)),c=c.slice(),l==="columns")for(let u=0,C=c.length;u<C;u++){let f=c[u];if(!(f instanceof Array))return;this.headers instanceof Array?(a?this.headers.push(`${f.shift()}`):h&&h instanceof Array&&this.headers.push(h[u]),this.table.setColumn(this.headers[u]||u.toString(),f)):m("JSONConverter: Invalid `columnNames` option.",!1)}else if(l==="rows"){a?this.headers=c.shift():h&&(this.headers=h);for(let u=0,C=c.length;u<C;u++){let f=c[u];if(g(f))for(let y=0,R=f.length;y<R;y++)this.columns.length<y+1&&this.columns.push([]),this.columns[y].push(f[y]),this.headers instanceof Array?this.table.setColumn(this.headers[y]||y.toString(),this.columns[y]):m("JSONConverter: Invalid `columnNames` option.",!1);else{let y=this.headers;if(y&&!(y instanceof Array)){let R={};t(y,(M,F)=>{R[F]=M.reduce((D,N)=>D[N],f)}),f=R}this.table.setRows([f],u)}}}this.emit({type:"afterParse",columns:this.columns,detail:o,headers:this.headers})}}getTable(){return this.table}}return r.defaultOptions={...d.defaultOptions,data:[],orientation:"rows"},r}),v(w,"Data/Connectors/JSONConnector.js",[w["Data/Connectors/DataConnector.js"],w["Core/Utilities.js"],w["Data/Converters/JSONConverter.js"]],function(d,b,p){let{merge:m}=b;class g extends d{constructor(t){let r=m(g.defaultOptions,t);super(r),this.converter=new p(r),this.options=r,r.enablePolling&&this.startPolling(1e3*Math.max(r.dataRefreshRate||0,1))}load(t){let r=this,e=r.converter,s=r.table,{data:o,dataUrl:i,dataModifier:l}=r.options;return r.emit({type:"load",data:o,detail:t,table:s}),Promise.resolve(i?fetch(i).then(a=>a.json()):o||[]).then(a=>(a&&(s.deleteColumns(),e.parse({data:a}),s.setColumns(e.getTable().getColumns())),r.setModifierOptions(l).then(()=>a))).then(a=>(r.emit({type:"afterLoad",data:a,detail:t,table:s}),r)).catch(a=>{throw r.emit({type:"loadError",detail:t,error:a,table:s}),a})}}return g.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},d.registerType("JSON",g),g}),v(w,"Data/Converters/GoogleSheetsConverter.js",[w["Data/Converters/DataConverter.js"],w["Core/Utilities.js"]],function(d,b){let{merge:p,uniqueKey:m}=b;class g extends d{constructor(t){let r=p(g.defaultOptions,t);super(r),this.columns=[],this.header=[],this.options=r}parse(t,r){let e,s=p(this.options,t),o=(s.json&&s.json.values||[]).map(i=>i.slice());if(o.length===0)return!1;this.header=[],this.columns=[],this.emit({type:"parse",columns:this.columns,detail:r,headers:this.header}),this.columns=o;for(let i=0,l=o.length;i<l;i++){e=o[i],this.header[i]=s.firstRowAsNames?`${e.shift()}`:m();for(let a=0,h=e.length;a<h;++a)if(e[a]&&typeof e[a]=="string"){let c=this.asGuessedType(e[a]);c instanceof Date&&(c=c.getTime()),this.columns[i][a]=c}}this.emit({type:"afterParse",columns:this.columns,detail:r,headers:this.header})}getTable(){return d.getTableFromColumns(this.columns,this.header)}}return g.defaultOptions={...d.defaultOptions},g}),v(w,"Data/Connectors/GoogleSheetsConnector.js",[w["Data/Connectors/DataConnector.js"],w["Data/Converters/GoogleSheetsConverter.js"],w["Core/Utilities.js"]],function(d,b,p){let{merge:m,pick:g}=p;class n extends d{constructor(r){let e=m(n.defaultOptions,r);super(e),this.converter=new b(e),this.options=e}load(r){let e=this,s=e.converter,o=e.table,{dataModifier:i,dataRefreshRate:l,enablePolling:a,firstRowAsNames:h,googleAPIKey:c,googleSpreadsheetKey:u}=e.options,C=n.buildFetchURL(c,u,e.options);return e.emit({type:"load",detail:r,table:o,url:C}),fetch(C).then(f=>f.json()).then(f=>{if(typeof f=="object"&&f&&typeof f.error=="object"&&f.error&&typeof f.error.code=="number"&&typeof f.error.message=="string"&&typeof f.error.status=="string")throw Error(f.error.message);return s.parse({firstRowAsNames:h,json:f}),o.deleteColumns(),o.setColumns(s.getTable().getColumns()),e.setModifierOptions(i)}).then(()=>(e.emit({type:"afterLoad",detail:r,table:o,url:C}),a&&setTimeout(()=>e.load(),1e3*Math.max(l||0,1)),e)).catch(f=>{throw e.emit({type:"loadError",detail:r,error:f,table:o}),f})}}return n.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",worksheet:1,enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0},function(t){let r="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function e(s={}){let{endColumn:o,endRow:i,googleSpreadsheetRange:l,startColumn:a,startRow:h}=s;return l||(r[a||0]||"A")+(Math.max(h||0,0)+1)+":"+(r[g(o,25)]||"Z")+(i?Math.max(i,0):"Z")}t.buildFetchURL=function(s,o,i={}){return`https://sheets.googleapis.com/v4/spreadsheets/${o}/values/`+(i.onlyColumnNames?"A1:Z1":e(i))+"?alt=json"+(i.onlyColumnNames?"":"&dateTimeRenderOption=FORMATTED_STRING&majorDimension=COLUMNS&valueRenderOption=UNFORMATTED_VALUE")+`&prettyPrint=false&key=${s}`},t.buildQueryRange=e}(n||(n={})),d.registerType("GoogleSheets",n),n}),v(w,"Data/Converters/HTMLTableConverter.js",[w["Data/Converters/DataConverter.js"],w["Core/Utilities.js"]],function(d,b){let{merge:p}=b;class m extends d{constructor(n){let t=p(m.defaultOptions,n);super(t),this.columns=[],this.headers=[],this.options=t,t.tableElement&&(this.tableElement=t.tableElement,this.tableElementID=t.tableElement.id)}export(n,t=this.options){let r=t.firstRowAsNames!==!1,e=t.useMultiLevelHeaders,s=n.getSortedColumns(t.usePresentationOrder),o=Object.keys(s),i=[],l=o.length,a=[],h="";if(r){let u=[];if(e){for(let C of o){let f=(s[C].shift()||"").toString();u.push(f)}h=this.getTableHeaderHTML(o,u,t)}else h=this.getTableHeaderHTML(void 0,o,t)}for(let u=0;u<l;u++){let C=s[o[u]],f=C.length;for(let y=0;y<f;y++){let R=C[y];a[y]||(a[y]=[]),typeof R=="string"||typeof R=="number"||R===void 0||(R=(R||"").toString()),a[y][u]=this.getCellHTMLFromValue(u?"td":"th",null,u?"":'scope="row"',R),u===l-1&&i.push("<tr>"+a[y].join("")+"</tr>")}}let c="";return t.tableCaption&&(c='<caption class="highcharts-table-caption">'+t.tableCaption+"</caption>"),"<table>"+c+h+"<tbody>"+i.join("")+"</tbody></table>"}getCellHTMLFromValue(n,t,r,e,s){let o=e,i="text"+(t?" "+t:"");return typeof o=="number"?(o=o.toString(),s===","&&(o=o.replace(".",s)),i="number"):e||(o="",i="empty"),"<"+n+(r?" "+r:"")+' class="'+i+'">'+o+"</"+n+">"}getTableHeaderHTML(n=[],t=[],r=this.options){let{useMultiLevelHeaders:e,useRowspanHeaders:s}=r,o="<thead>",i=0,l=t&&t.length,a,h=0,c;if(e&&n&&t&&!function(u,C){let f=u.length;if(C.length!==f)return!1;for(;--f;)if(u[f]!==C[f])return!1;return!0}(n,t)){for(o+="<tr>";i<l;++i)(a=n[i])===n[i+1]?++h:h?(o+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(h+1)+'"',a),h=0):(a===t[i]?s?(c=2,delete t[i]):(c=1,t[i]=""):c=1,o+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(c>1?' valign="top" rowspan="'+c+'"':""),a));o+="</tr>"}if(t){for(o+="<tr>",i=0,l=t.length;i<l;++i)t[i]!==void 0&&(o+=this.getCellHTMLFromValue("th",null,'scope="col"',t[i]));o+="</tr>"}return o+"</thead>"}parse(n,t){let r=[],e=[],s=p(this.options,n),{endRow:o,startColumn:i,endColumn:l,firstRowAsNames:a}=s,h=s.tableElement||this.tableElement;if(!(h instanceof HTMLElement)){this.emit({type:"parseError",columns:r,detail:t,headers:e,error:"Not a valid HTML Table"});return}this.tableElement=h,this.tableElementID=h.id,this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers});let c=h.getElementsByTagName("tr"),u=c.length,C=0,f,{startRow:y}=s;if(a&&u){let R=c[0].children,M=R.length;for(let F=i;F<M&&!(F>l);F++)((f=R[F]).tagName==="TD"||f.tagName==="TH")&&e.push(f.innerHTML);y++}for(;C<u;){if(C>=y&&C<=o){let R=c[C].children,M=R.length,F=0;for(;F<M;){let D=F-i,N=r[D];if(((f=R[F]).tagName==="TD"||f.tagName==="TH")&&F>=i&&F<=l){r[D]||(r[D]=[]);let j=this.asGuessedType(f.innerHTML);j instanceof Date&&(j=j.getTime()),r[D][C-y]=j;let T=1;for(;C-y>=T&&N[C-y-T]===void 0;)N[C-y-T]=null,T++}F++}}C++}this.columns=r,this.headers=e,this.emit({type:"afterParse",columns:r,detail:t,headers:e})}getTable(){return d.getTableFromColumns(this.columns,this.headers)}}return m.defaultOptions={...d.defaultOptions,useRowspanHeaders:!0,useMultiLevelHeaders:!0},m}),v(w,"Data/Connectors/HTMLTableConnector.js",[w["Data/Connectors/DataConnector.js"],w["Core/Globals.js"],w["Data/Converters/HTMLTableConverter.js"],w["Core/Utilities.js"]],function(d,b,p,m){let{win:g}=b,{merge:n}=m;class t extends d{constructor(e){let s=n(t.defaultOptions,e);super(s),this.converter=new p(s),this.options=s}load(e){let s,o=this,i=o.converter,l=o.table,{dataModifier:a,table:h}=o.options;if(o.emit({type:"load",detail:e,table:l,tableElement:o.tableElement}),typeof h=="string"?(o.tableID=h,s=g.document.getElementById(h)):(s=h,o.tableID=s.id),o.tableElement=s||void 0,!o.tableElement){let c="HTML table not provided, or element with ID not found";return o.emit({type:"loadError",detail:e,error:c,table:l}),Promise.reject(Error(c))}return i.parse(n({tableElement:o.tableElement},o.options),e),l.deleteColumns(),l.setColumns(i.getTable().getColumns()),o.setModifierOptions(a).then(()=>(o.emit({type:"afterLoad",detail:e,table:l,tableElement:o.tableElement}),o))}}return t.defaultOptions={table:""},d.registerType("HTMLTable",t),t}),v(w,"Data/Modifiers/ChainModifier.js",[w["Data/Modifiers/DataModifier.js"],w["Core/Utilities.js"]],function(d,b){let{merge:p}=b;class m extends d{constructor(n,...t){super(),this.chain=t,this.options=p(m.defaultOptions,n);let r=this.options.chain||[];for(let e=0,s=r.length,o,i;e<s;++e)(o=r[e]).type&&(i=d.types[o.type])&&t.push(new i(o))}add(n,t){this.emit({type:"addModifier",detail:t,modifier:n}),this.chain.push(n),this.emit({type:"addModifier",detail:t,modifier:n})}clear(n){this.emit({type:"clearChain",detail:n}),this.chain.length=0,this.emit({type:"afterClearChain",detail:n})}modify(n,t){let r=this.options.reverse?this.chain.slice().reverse():this.chain.slice();n.modified===n&&(n.modified=n.clone(!1,t));let e=Promise.resolve(n);for(let s=0,o=r.length;s<o;++s){let i=r[s];e=e.then(l=>i.modify(l.modified,t))}return(e=e.then(s=>(n.modified.deleteColumns(),n.modified.setColumns(s.modified.getColumns()),n))).catch(s=>{throw this.emit({type:"error",detail:t,table:n}),s})}modifyCell(n,t,r,e,s){let o=this.options.reverse?this.chain.reverse():this.chain;if(o.length){let i=n.clone();for(let l=0,a=o.length;l<a;++l)o[l].modifyCell(i,t,r,e,s),i=i.modified;n.modified=i}return n}modifyColumns(n,t,r,e){let s=this.options.reverse?this.chain.reverse():this.chain.slice();if(s.length){let o=n.clone();for(let i=0,l=s.length;i<l;++i)s[i].modifyColumns(o,t,r,e),o=o.modified;n.modified=o}return n}modifyRows(n,t,r,e){let s=this.options.reverse?this.chain.reverse():this.chain.slice();if(s.length){let o=n.clone();for(let i=0,l=s.length;i<l;++i)s[i].modifyRows(o,t,r,e),o=o.modified;n.modified=o}return n}modifyTable(n,t){this.emit({type:"modify",detail:t,table:n});let r=this.options.reverse?this.chain.reverse():this.chain.slice(),e=n.modified;for(let s=0,o=r.length;s<o;++s)e=r[s].modifyTable(e,t).modified;return n.modified=e,this.emit({type:"afterModify",detail:t,table:n}),n}remove(n,t){let r=this.chain;this.emit({type:"removeModifier",detail:t,modifier:n}),r.splice(r.indexOf(n),1),this.emit({type:"afterRemoveModifier",detail:t,modifier:n})}}return m.defaultOptions={type:"Chain"},d.registerType("Chain",m),m}),v(w,"Data/Modifiers/InvertModifier.js",[w["Data/Modifiers/DataModifier.js"],w["Core/Utilities.js"]],function(d,b){let{merge:p}=b;class m extends d{constructor(n){super(),this.options=p(m.defaultOptions,n)}modifyCell(n,t,r,e,s){let o=n.modified,i=o.getRowIndexBy("columnNames",t);return i===void 0?o.setColumns(this.modifyTable(n.clone()).getColumns(),void 0,s):o.setCell(`${r}`,i,e,s),n}modifyColumns(n,t,r,e){let s=n.modified,o=s.getColumn("columnNames")||[],i=n.getColumnNames(),l=n.getRowCount()!==o.length;if(!l){for(let a=0,h=i.length;a<h;++a)if(i[a]!==o[a]){l=!0;break}}if(l)return this.modifyTable(n,e);i=Object.keys(t);for(let a=0,h=i.length,c,u,C;a<h;++a){c=t[u=i[a]],C=s.getRowIndexBy("columnNames",u)||s.getRowCount();for(let f=0,y=r,R=c.length;f<R;++f,++y)s.setCell(`${y}`,C,c[f],e)}return n}modifyRows(n,t,r,e){let s=n.getColumnNames(),o=n.modified,i=o.getColumn("columnNames")||[],l=n.getRowCount()!==i.length;if(!l){for(let a=0,h=s.length;a<h;++a)if(s[a]!==i[a]){l=!0;break}}if(l)return this.modifyTable(n,e);for(let a=0,h=r,c=t.length,u;a<c;++a,++h)if((u=t[a])instanceof Array)o.setColumn(`${h}`,u);else for(let C=0,f=s.length;C<f;++C)o.setCell(`${h}`,C,u[s[C]],e);return n}modifyTable(n,t){this.emit({type:"modify",detail:t,table:n});let r=n.modified;if(n.hasColumns(["columnNames"])){let e=((n.deleteColumns(["columnNames"])||{}).columnNames||[]).map(o=>`${o}`),s={};for(let o=0,i=n.getRowCount(),l;o<i;++o)(l=n.getRow(o))&&(s[e[o]]=l);r.deleteColumns(),r.setColumns(s)}else{let e={};for(let s=0,o=n.getRowCount(),i;s<o;++s)(i=n.getRow(s))&&(e[`${s}`]=i);e.columnNames=n.getColumnNames(),r.deleteColumns(),r.setColumns(e)}return this.emit({type:"afterModify",detail:t,table:n}),n}}return m.defaultOptions={type:"Invert"},d.registerType("Invert",m),m}),v(w,"Data/Modifiers/MathModifier.js",[w["Data/Modifiers/DataModifier.js"],w["Data/Formula/FormulaParser.js"],w["Data/Formula/FormulaProcessor.js"]],function(d,b,p){class m extends d{constructor(n){super(),this.options={...m.defaultOptions,...n}}modifyTable(n,t){this.emit({type:"modify",detail:t,table:n});let r=this.options.alternativeSeparators,e=this.options.formulaColumns||n.getColumnNames(),s=n.modified;for(let i=0,l=e.length,a;i<l;++i)a=e[i],e.indexOf(a)>=0&&s.setColumn(a,this.processColumn(n,a));let o=this.options.columnFormulas||[];for(let i=0,l=o.length,a,h;i<l;++i)a=o[i],h=b.parseFormula(a.formula,r),s.setColumn(a.column,this.processColumnFormula(h,n,a.rowStart,a.rowEnd));return this.emit({type:"afterModify",detail:t,table:n}),n}processColumn(n,t,r=0){let e=this.options.alternativeSeparators,s=(n.getColumn(t,!0)||[]).slice(r>0?r:0);for(let o=0,i=s.length,l=[],a;o<i;++o)if(typeof(a=s[o])=="string"&&a[0]==="=")try{l=a===""?l:b.parseFormula(a.substring(1),e),s[o]=p.processFormula(l,n)}catch{s[o]=NaN}return s}processColumnFormula(n,t,r=0,e=t.getRowCount()){r=r>=0?r:0,e=e>=0?e:t.getRowCount()+e;let s=[],o=t.modified;for(let i=0,l=e-r;i<l;++i)try{s[i]=p.processFormula(n,o)}catch{s[i]=NaN}finally{n=p.translateReferences(n,0,1)}return s}}return m.defaultOptions={type:"Math",alternativeSeparators:!1},d.registerType("Math",m),m}),v(w,"Data/Modifiers/RangeModifier.js",[w["Data/Modifiers/DataModifier.js"],w["Core/Utilities.js"]],function(d,b){let{merge:p}=b;class m extends d{constructor(n){super(),this.options=p(m.defaultOptions,n)}modifyTable(n,t){this.emit({type:"modify",detail:t,table:n});let{additive:r,ranges:e,strict:s}=this.options;if(e.length){let o=n.modified,i=n.getColumns(),l=[];for(let a=0,h=e.length,c,u;a<h;++a)if(c=e[a],!s||typeof c.minValue==typeof c.maxValue){a>0&&!r&&(o.deleteRows(),o.setRows(l),i=o.getColumns(),l=[]),u=i[c.column]||[];for(let C=0,f=u.length,y,R;C<f;++C){switch(typeof(y=u[C])){default:continue;case"boolean":case"number":case"string":}(!s||typeof y==typeof c.minValue)&&y>=c.minValue&&y<=c.maxValue&&(R=r?n.getRow(C):o.getRow(C))&&l.push(R)}}o.deleteRows(),o.setRows(l)}return this.emit({type:"afterModify",detail:t,table:n}),n}}return m.defaultOptions={type:"Range",ranges:[]},d.registerType("Range",m),m}),v(w,"Data/Modifiers/SortModifier.js",[w["Data/Modifiers/DataModifier.js"],w["Data/DataTable.js"],w["Core/Utilities.js"]],function(d,b,p){let{merge:m}=p;class g extends d{static ascending(t,r){return(t||0)<(r||0)?-1:(t||0)>(r||0)?1:0}static descending(t,r){return(r||0)<(t||0)?-1:(r||0)>(t||0)?1:0}constructor(t){super(),this.options=m(g.defaultOptions,t)}getRowReferences(t){let r=t.getRows(),e=[];for(let s=0,o=r.length;s<o;++s)e.push({index:s,row:r[s]});return e}modifyCell(t,r,e,s,o){let{orderByColumn:i,orderInColumn:l}=this.options;return r===i&&(l?(t.modified.setCell(r,e,s),t.modified.setColumn(l,this.modifyTable(new b({columns:t.getColumns([i,l])})).modified.getColumn(l))):this.modifyTable(t,o)),t}modifyColumns(t,r,e,s){let{orderByColumn:o,orderInColumn:i}=this.options,l=Object.keys(r);return l.indexOf(o)>-1&&(i&&r[l[0]].length?(t.modified.setColumns(r,e),t.modified.setColumn(i,this.modifyTable(new b({columns:t.getColumns([o,i])})).modified.getColumn(i))):this.modifyTable(t,s)),t}modifyRows(t,r,e,s){let{orderByColumn:o,orderInColumn:i}=this.options;return i&&r.length?(t.modified.setRows(r,e),t.modified.setColumn(i,this.modifyTable(new b({columns:t.getColumns([o,i])})).modified.getColumn(i))):this.modifyTable(t,s),t}modifyTable(t,r){this.emit({type:"modify",detail:r,table:t});let e=t.getColumnNames(),s=t.getRowCount(),o=this.getRowReferences(t),{direction:i,orderByColumn:l,orderInColumn:a}=this.options,h=i==="asc"?g.ascending:g.descending,c=e.indexOf(l),u=t.modified;if(c!==-1&&o.sort((C,f)=>h(C.row[c],f.row[c])),a){let C=[];for(let f=0;f<s;++f)C[o[f].index]=f;u.setColumns({[a]:C})}else{let C=[];for(let f=0;f<s;++f)C.push(o[f].row);u.setRows(C,0)}return this.emit({type:"afterModify",detail:r,table:t}),t}}return g.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},d.registerType("Sort",g),g}),v(w,"masters/modules/data-tools.src.js",[w["Core/Globals.js"],w["Data/Connectors/DataConnector.js"],w["Data/Converters/DataConverter.js"],w["Data/DataCursor.js"],w["Data/Modifiers/DataModifier.js"],w["Data/DataPool.js"],w["Data/DataTable.js"],w["Data/Formula/Formula.js"]],function(d,b,p,m,g,n,t,r){return d.DataConnector=d.DataConnector||b,d.DataConverter=d.DataConverter||p,d.DataCursor=d.DataCursor||m,d.DataModifier=d.DataModifier||g,d.DataPool=d.DataPool||n,d.DataTable=d.DataTable||t,d.Formula=d.Formula||r,d})})})(L);var U=L.exports;const $=k(U),G=Y({__proto__:null,default:$},[U]);export{G as d};
